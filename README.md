# iMessage Data Foundry

ğŸ­ Generate realistic, schema-accurate iMessage databases for testing and development.

## Overview

iMessage Data Foundry creates synthetic `chat.db` SQLite databases that exactly mirror the macOS iMessage schema. It uses AI to generate realistic personas and conversations, producing databases suitable for:

- **Testing** iMessage analysis tools and exporters
- **Development** of applications that interface with iMessage data
- **Demos** and documentation requiring realistic message data

## Features

- âœ… **Full Schema Replication** â€” Exact match of macOS iMessage `chat.db` structure
- âœ… **Multi-Version Support** â€” Sonoma (14.x), Sequoia (15.x), and Tahoe (26.x)
- âœ… **AI-Powered Personas** â€” Generate realistic personas with distinct personalities
- âœ… **Natural Conversations** â€” LLM-generated messages that feel authentic
- âœ… **Persona Library** â€” Save and reuse personas across database generations
- âœ… **Group Chats** â€” Support for both 1:1 and group conversations
- âœ… **Realistic Timestamps** â€” Natural message timing with conversation batching
- âœ… **Attachment Stubs** â€” Placeholder attachments with proper database records

## Installation

```bash
# Clone the repository
git clone https://github.com/yourusername/imessage-data-foundry.git
cd imessage-data-foundry

# Install with uv
uv sync

# Or install with pip
pip install -e .
```

## Quick Start

```bash
# Launch the TUI
uvx imessage-data-foundry

# Or run directly
uv run python -m imessage_data_foundry
```

## Configuration

On first run, you'll be prompted to configure:

1. **LLM Provider** â€” Choose OpenAI or Anthropic
2. **API Key** â€” Your API key for the selected provider
3. **macOS Version** â€” Target schema version (auto-detects by default)

Configuration is stored in `~/.config/imessage-data-foundry/config.toml`.

## Usage

### Creating Personas

Personas can be created manually or generated by AI:

```
â”Œâ”€ Create Persona â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                  â”‚
â”‚  Name: Sarah Chen                                â”‚
â”‚  Phone: +1 (555) 123-4567                        â”‚
â”‚  Relationship: Close friend from college         â”‚
â”‚                                                  â”‚
â”‚  Personality:                                    â”‚
â”‚  Outgoing, tech-savvy software engineer who      â”‚
â”‚  loves hiking and craft coffee. Quick to         â”‚
â”‚  respond with enthusiasm and emoji.              â”‚
â”‚                                                  â”‚
â”‚  [Generate with AI]  [Save]  [Cancel]            â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Generating Conversations

1. Select personas to include
2. Choose chat type (1:1 or group)
3. Set message count target
4. Optionally provide a conversation seed
5. Generate!

### Output

The generated `chat.db` file can be used with any tool that reads iMessage databases:

```bash
# Example: Use with imessage-exporter
imessage-exporter -p ./output/chat.db -f html -o ./export/
```

## API Keys

You'll need an API key from one of the supported providers:

| Provider | Get API Key |
|----------|-------------|
| OpenAI | https://platform.openai.com/api-keys |
| Anthropic | https://console.anthropic.com/settings/keys |

Set via environment variable or enter in the TUI:

```bash
export OPENAI_API_KEY="sk-..."
# or
export ANTHROPIC_API_KEY="sk-ant-..."
```

## Project Structure

```
imessage-data-foundry/
â”œâ”€â”€ src/imessage_data_foundry/
â”‚   â”œâ”€â”€ app.py              # Textual TUI application
â”‚   â”œâ”€â”€ db/                 # Database schema and building
â”‚   â”œâ”€â”€ personas/           # Persona management
â”‚   â”œâ”€â”€ conversations/      # Conversation generation
â”‚   â”œâ”€â”€ llm/                # LLM provider integrations
â”‚   â””â”€â”€ ui/                 # TUI screens and widgets
â”œâ”€â”€ data/
â”‚   â””â”€â”€ foundry.db          # Local persona library
â””â”€â”€ tests/
```

## Schema Compatibility

Generated databases are tested for compatibility with:

- [imessage-exporter](https://github.com/ReagentX/imessage-exporter)
- [imessage_reader](https://github.com/niftycode/imessage_reader)
- [imessage_tools](https://github.com/my-other-github-account/imessage_tools)

## Limitations

- **Text-only focus** â€” Reactions, read receipts, and message effects are not simulated
- **Placeholder attachments** â€” Attachments are stubs, not real media files
- **macOS-centric** â€” Schema targets macOS; iOS backup databases may differ slightly

## Development

```bash
# Install dev dependencies
uv sync --dev

# Run tests
uv run pytest

# Run type checking
uv run mypy src/

# Format code
uv run ruff format src/
```

## License

MIT License â€” See [LICENSE](LICENSE) for details.

## Acknowledgments

- Schema research informed by [imessage-exporter](https://github.com/ReagentX/imessage-exporter)
- Built with [Textual](https://textual.textualize.io/) for the beautiful TUI
